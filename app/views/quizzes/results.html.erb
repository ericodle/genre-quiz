<div class="quiz-results">
  <h2>Quiz Results<br><span style="font-size: 0.7em; font-weight: 400;">測驗結果</span></h2>

  <div class="results-summary">
    <div class="summary-card">
      <h3>Overall Performance<br><span style="font-size: 0.8em; font-weight: 400;">整體表現</span></h3>
      <div class="score-display">
        <div class="score-number"><%= @total_correct %> / <%= @total_questions %></div>
        <div class="score-percentage"><%= number_with_precision(@accuracy, precision: 1) %>%</div>
      </div>
    </div>
  </div>

  <div class="results-by-genre">
    <h3>Performance by Genre<br><span style="font-size: 0.8em; font-weight: 400;">各類型表現</span></h3>
    <table class="results-table">
      <thead>
        <tr>
          <th>Genre / 類型</th>
          <th>Correct / 正確</th>
          <th>Total / 總數</th>
          <th>Accuracy / 準確率</th>
        </tr>
      </thead>
      <tbody>
        <% @results_by_genre.each do |result| %>
          <tr>
            <td><%= genre_with_chinese(result[:genre]) %></td>
            <td><%= result[:correct] %></td>
            <td><%= result[:total] %></td>
            <td><%= number_with_precision(result[:accuracy], precision: 1) %>%</td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="detailed-results">
    <h3>Question Details<br><span style="font-size: 0.8em; font-weight: 400;">問題詳情</span></h3>
    <div class="questions-list">
      <% @questions.each do |question| %>
        <div class="question-result <%= question.answer&.is_correct ? 'correct' : 'incorrect' %>">
          <div class="question-header">
            <span class="question-number">Q<%= question.question_number %></span>
            <span class="question-status">
              <%= question.answer&.is_correct ? '✓ Correct / 正確' : '✗ Incorrect / 錯誤' %>
            </span>
          </div>
          <div class="question-details">
            <p><strong>Your answer / 您的答案:</strong> <%= genre_with_chinese(question.answer&.selected_genre) %></p>
            <p><strong>Correct answer / 正確答案:</strong> <%= genre_with_chinese(question.song.genre) %></p>
            <% if question.time_spent_seconds %>
              <p><strong>Time spent / 花費時間:</strong> <%= number_with_precision(question.time_spent_seconds, precision: 1) %> seconds / 秒</p>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="results-actions">
    <%= link_to "Start New Quiz / 開始新測驗", root_path, class: "btn btn-primary" %>
  </div>
</div>

